{"version":3,"file":"TextField-CU5_npzy.js","sources":["../../src/components/FormFields/TextField.tsx"],"sourcesContent":["import { Field, Input, makeStyles, mergeClasses, tokens, type FieldProps, type InputProps, type TextProps, Text, typographyStyles } from \"@fluentui/react-components\";\nimport { useTranslation } from \"react-i18next\";\nimport { useWfgFormContext } from \"../../hooks/useWfgFormContext\";\nimport { csvToSet } from \"../../utils\";\nimport { useFormInitQuery } from \"../../hooks/useFormInitQuery\";\nimport { useStore } from \"@tanstack/react-form\";\nimport { useFieldContext } from \"../../hooks/formContext\";\n\ntype TextFieldProps = InputProps & {\n    fieldProps?: FieldProps\n    readonlyFieldProps?: FieldProps\n    readonlyInputProps?: InputProps\n    printFieldProps?: FieldProps\n    printTextProps?: TextProps\n};\n\nexport const usePrintStyles = makeStyles({\n    text: {\n        minHeight: '32px',\n        ...typographyStyles.body1,\n        display: 'inline-flex',\n        alignItems: 'center',\n        boxSizing: 'border-box',\n        padding: `0 ${tokens.spacingHorizontalM}`\n    },\n    small: {\n        minHeight: '24px',\n        ...typographyStyles.caption1,\n        padding: `0 ${tokens.spacingHorizontalS}`\n    },\n    large: {\n        minHeight: '40px',\n        ...typographyStyles.body2,\n        padding: `0 calc(${tokens.spacingHorizontalM} + ${tokens.spacingHorizontalSNudge})`\n    },\n    readonly: {\n        '& input': {\n            cursor: 'default !important'\n        }\n    }\n});\nfunction PrintView(props: TextFieldProps) {\n    const { printFieldProps = props.fieldProps, printTextProps = {} } = props;\n    const styles = usePrintStyles();\n    const field = useFieldContext<string | null>();\n    const { t } = useTranslation();\n\n    return (\n        <Field\n            label={t(field.name)}\n            {...printFieldProps}\n        >\n            <Text \n                className={mergeClasses(styles.text, printFieldProps?.size === 'small' && styles.small, printFieldProps?.size === 'large' && styles.large, printTextProps.className)}\n            >\n                {field.state.value}\n            </Text>\n        </Field>\n    );\n}\nfunction ReadonlyView(props: TextFieldProps) {\n    const { readonlyFieldProps = props.fieldProps, readonlyInputProps = {} } = props;\n    const styles = usePrintStyles();\n    const field = useFieldContext<string | null>();\n    const { t } = useTranslation();\n    const { form } = useWfgFormContext();\n\n    return (\n        <form.Subscribe \n            selector={s => s.values.Table1[0].FORM_FIELDS_REQUIRED}\n            children={FORM_FIELDS_REQUIRED => {\n                const requiredFields = csvToSet(FORM_FIELDS_REQUIRED);\n                const required = requiredFields.has(field.name.replace('Table1[0].', ''));\n                return (\n                    <Field\n                        required={required}\n                        label={t(field.name)}\n                        {...readonlyFieldProps}\n                    >\n                        <Input \n                            readOnly\n                            defaultValue={field.state.value ?? ''}\n                            className={styles.readonly}\n                            {...readonlyInputProps}\n                        />\n                    </Field>\n                );\n            }}\n        />\n    );\n}\nfunction View(props: TextFieldProps) {\n    const { fieldProps = {}, readonlyFieldProps, readonlyInputProps, printFieldProps, printTextProps, ...inputProps } = props;\n    const field = useFieldContext<string | null>();\n    const { t } = useTranslation();\n    const { form } = useWfgFormContext();\n    const value = field.state.value ?? '';\n\n    return (\n        <form.Subscribe \n            selector={s => s.values.Table1[0].FORM_FIELDS_REQUIRED}\n            children={FORM_FIELDS_REQUIRED => {\n                const requiredFields = csvToSet(FORM_FIELDS_REQUIRED);\n                const required = requiredFields.has(field.name.replace('Table1[0].', ''));\n                return (\n                    <Field\n                        required={required}\n                        label={t(field.name)}\n                        validationMessage={field.state.meta.isTouched && field.state.meta.errors.length > 0 ? t(field.state.meta.errors[0], { length: field.state.meta.errors[0].rule, actual: value.length }) : null}\n                        {...fieldProps}\n                    >\n                        <Input\n                            value={value}\n                            onChange={(_, { value }) => { field.handleChange(value); }}\n                            onBlur={() => { field.handleBlur(); }}\n                            {...inputProps}\n                        />\n                    </Field>\n                );\n            }}\n        />\n    );\n}\nexport default (props: TextFieldProps) => {\n    const field = useFieldContext();\n    const { form, printForm: { state: { values: { open: isPrintView } } } } = useWfgFormContext();\n    const { isArchive } = useFormInitQuery();\n    const FORM_FIELDS_READONLY = useStore(form.store, s => s.values.Table1[0].FORM_FIELDS_READONLY ?? '');\n    const readonlyFields = csvToSet(FORM_FIELDS_READONLY);\n    return isPrintView ? <PrintView {...props} /> : isArchive || readonlyFields.has(field.name.replace('Table1[0].', '')) ? <ReadonlyView {...props} /> : <View {...props} />;\n};"],"names":["usePrintStyles","makeStyles","typographyStyles","tokens","PrintView","props","printFieldProps","printTextProps","styles","field","useFieldContext","t","useTranslation","jsx","Field","Text","mergeClasses","ReadonlyView","readonlyFieldProps","readonlyInputProps","form","useWfgFormContext","s","FORM_FIELDS_REQUIRED","required","csvToSet","Input","View","fieldProps","inputProps","value","_","TextField","isPrintView","isArchive","useFormInitQuery","FORM_FIELDS_READONLY","useStore","readonlyFields"],"mappings":"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"}