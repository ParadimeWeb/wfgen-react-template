import{aw as se,b as w,d as a,y as be,i as ge,Y as H,ax as re,ay as N,av as G,S as U,z as Q,A as q,E as Z,N as Oe,az as Ce,aA as xe,M as me,P as ye,aB as he,L as X,ab as ke,ag as Ae,aC as Se,c as ie,g as De,$ as B,j as $,ae as Ie,_ as we,m as Re,e as Te,aD as Be,aj as ee,a as Ve,aE as Ee,a2 as Ne,u as Me}from"./index-DImuVcwS.js";function ce(e){const o=se(),r=w(e);a.useEffect(()=>{const t=o.current;if(t){const n=f=>{r(f)};return t.subscribe(n),n(t.isNavigatingWithKeyboard()),()=>{t.unsubscribe(n)}}},[o,r])}function Fe(){const e=se();return a.useCallback(o=>{var r;(r=e.current)===null||r===void 0||r.setVal(o)},[e])}function Pe(e){const{matchOption:o}=e,{targetDocument:r}=be(),t=a.useRef(null),n=a.useRef(null),f=a.useCallback(l=>ge(l)&&o(l)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,[o]),b=a.useCallback(l=>{l&&r?(n.current=l,t.current=r.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,f)):n.current=null},[r,f]);return{optionWalker:a.useMemo(()=>({first:()=>!t.current||!n.current?null:(t.current.currentNode=n.current,t.current.firstChild()),last:()=>!t.current||!n.current?null:(t.current.currentNode=n.current,t.current.lastChild()),next:()=>t.current?t.current.nextNode():null,prev:()=>t.current?t.current.previousNode():null,find:(l,i)=>{if(!t.current||!n.current)return null;const v=i?r==null?void 0:r.getElementById(i):null;t.current.currentNode=v??n.current;let p=t.current.currentNode;for(;p&&!l(p.id);)p=t.current.nextNode();return p},setCurrent:l=>{t.current&&(t.current.currentNode=l)}}),[r]),listboxCallbackRef:b}}const te="data-activedescendant",F="data-activedescendant-focusvisible",ne=e=>{if(!e)return;const o=ae(e.parentElement);if(!o)return;const{offsetHeight:r}=e,t=le(e,o),{scrollMarginTop:n,scrollMarginBottom:f}=Le(e),{offsetHeight:b,scrollTop:u}=o,l=t-n<u,i=t+r+f>u+b,v=2;l?o.scrollTo(0,t-n-v):i&&o.scrollTo(0,t+r+f-b+v)},ae=e=>e?e.scrollHeight>e.offsetHeight?e:ae(e.parentElement):null,le=(e,o)=>!e||e===o?0:e.contains(o)?o.offsetTop*-1:e.offsetTop+le(e.offsetParent,o),Le=e=>{var o;const r=(o=e.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!r)return{scrollMarginTop:0,scrollMarginBottom:0};const t=r.getComputedStyle(e);var n;const f=(n=K(t.scrollMarginTop))!==null&&n!==void 0?n:K(t.scrollMarginBlockStart);var b;const u=(b=K(t.scrollMarginBottom))!==null&&b!==void 0?b:K(t.scrollMarginBlockEnd);return{scrollMarginTop:f,scrollMarginBottom:u}},K=e=>e?parseInt(e,10):0,_e=e=>new CustomEvent("activedescendantchange",{bubbles:!0,cancelable:!1,composed:!0,detail:e});function Ue(e){const{imperativeRef:o,matchOption:r}=e,t=a.useRef(!1),n=a.useRef(!0),f=a.useRef(null),b=a.useRef(null),u=a.useRef(null),l=a.useRef(!0),i=a.useCallback(()=>{var s;(s=u.current)===null||s===void 0||s.removeAttribute("aria-activedescendant")},[]),v=a.useCallback(s=>{if(s&&(f.current=s),l.current&&f.current){var d;(d=u.current)===null||d===void 0||d.setAttribute("aria-activedescendant",f.current)}},[]);ce(s=>{t.current=s;const d=c();d&&(s&&n.current?d.setAttribute(F,""):d.removeAttribute(F))});const p=w(r),C=a.useRef(null),{optionWalker:x,listboxCallbackRef:I}=Pe({matchOption:p}),c=a.useCallback(()=>{var s;return(s=C.current)===null||s===void 0?void 0:s.querySelector(`#${f.current}`)},[C]),D=a.useCallback(s=>{n.current=s;const d=c();d&&(s&&t.current?d.setAttribute(F,""):d.removeAttribute(F))},[c]),y=a.useCallback(()=>{const s=c();s&&(s.removeAttribute(te),s.removeAttribute(F)),i(),b.current=f.current,f.current=null;var d;return(d=s==null?void 0:s.id)!==null&&d!==void 0?d:null},[c,i]),h=a.useCallback(s=>{if(!s)return;const d=y();ne(s),v(s.id),s.setAttribute(te,""),t.current&&n.current&&s.setAttribute(F,"");const k=_e({id:s.id,previousId:d});s.dispatchEvent(k)},[y,v]),m=a.useMemo(()=>({first:({passive:s}={})=>{const d=x.first();return s||h(d),d==null?void 0:d.id},last:({passive:s}={})=>{const d=x.last();return s||h(d),d==null?void 0:d.id},next:({passive:s}={})=>{const d=c();if(!d)return;x.setCurrent(d);const k=x.next();return s||h(k),k==null?void 0:k.id},prev:({passive:s}={})=>{const d=c();if(!d)return;x.setCurrent(d);const k=x.prev();return s||h(k),k==null?void 0:k.id},blur:()=>{y()},active:()=>{var s;return(s=c())===null||s===void 0?void 0:s.id},focus:s=>{if(!C.current)return;const d=C.current.querySelector(`#${s}`);d&&h(d)},focusLastActive:()=>{if(!C.current||!b.current)return;const s=C.current.querySelector(`#${b.current}`);if(s)return h(s),!0},find(s,{passive:d,startFrom:k}={}){const V=x.find(s,k);return d||h(V),V==null?void 0:V.id},scrollActiveIntoView:()=>{if(!C.current)return;const s=c();s&&ne(s)},showAttributes(){l.current=!0,v()},hideAttributes(){l.current=!1,i()},showFocusVisibleAttributes(){D(!0)},hideFocusVisibleAttributes(){D(!1)}}),[x,C,v,i,h,y,c,D]);return a.useImperativeHandle(o,()=>m),{listboxRef:H(C,I),activeParentRef:u,controller:m}}function Ke(e){const o=re(G),{getOptionById:r,getOptionsMatchingValue:t,multiselect:n,registerOption:f,selectedOptions:b,selectOption:u,activeDescendantController:l}=e,i=N(c=>c.registerOption),v=N(c=>c.onOptionClick),p=N(c=>c.onActiveDescendantChange),x={activeOption:void 0,focusVisible:!1,getOptionById:r,getOptionsMatchingValue:t,multiselect:n,registerOption:o?i:f,selectedOptions:b,selectOption:u,setActiveOption:()=>{},onOptionClick:v,onActiveDescendantChange:p},I=a.useMemo(()=>({controller:l}),[l]);return{listbox:x,activeDescendant:I}}function ue(e,o={}){const{open:r=!0,multiselect:t=!1}=o,n=e.key,{altKey:f,ctrlKey:b,key:u,metaKey:l}=e;return u.length===1&&n!==U&&!f&&!b&&!l?"Type":r?n===q&&f||n===Z||!t&&n===U?"CloseSelect":t&&n===U?"Select":n===Oe?"Close":n===Q?"Next":n===q?"Previous":n===Ce?"First":n===xe?"Last":n===me?"PageUp":n===ye?"PageDown":n===he?"Tab":"None":n===Q||n===q||n===Z||n===U?"Open":"None"}const de=()=>{const e=a.useRef(new Map),o=a.useMemo(()=>({getCount:()=>e.current.size,getOptionAtIndex:()=>{},getIndexOfId:()=>-1,getOptionById:i=>e.current.get(i),getOptionsMatchingText:i=>Array.from(e.current.values()).filter(({text:v})=>i(v)),getOptionsMatchingValue:i=>{const v=[];for(const p of e.current.values())i(p.value)&&v.push(p);return v}}),[]),r=a.useCallback(t=>(e.current.set(t.id,t),()=>e.current.delete(t.id)),[]);return{...o,options:Array.from(e.current.values()),registerOption:r}},fe=e=>{const{defaultSelectedOptions:o,multiselect:r,onOptionSelect:t}=e,[n,f]=X({state:e.selectedOptions,defaultState:o,initialState:[]}),b=a.useCallback((l,i)=>{if(i.disabled)return;let v=[i.value];if(r){const p=n.findIndex(C=>C===i.value);p>-1?v=[...n.slice(0,p),...n.slice(p+1)]:v=[...n,i.value]}f(v),t==null||t(l,{optionValue:i.value,optionText:i.text,selectedOptions:v})},[t,r,n,f]);return{clearSelection:l=>{f([]),t==null||t(l,{optionValue:void 0,optionText:void 0,selectedOptions:[]})},selectOption:b,selectedOptions:n}},oe={activeOption:void 0,focusVisible:!1,setActiveOption:()=>null},He=(e,o)=>{"use no memo";const{multiselect:r,disableAutoFocus:t=!1}=e,n=de(),{listboxRef:f,activeParentRef:b,controller:u}=Ue({matchOption:g=>g.classList.contains(ke.root)}),l=re(G),i=N(g=>g.onActiveDescendantChange),v=N(g=>g.getOptionById),p=N(g=>g.getOptionsMatchingValue),C=l?v:n.getOptionById,x=l?p:n.getOptionsMatchingValue,I=a.useMemo(()=>{let g=null;const R=T=>{const E=T;i==null||i(E)};return T=>{if(!T){g==null||g.removeEventListener("activedescendantchange",R);return}g=T,g.addEventListener("activedescendantchange",R)}},[i]),[c,D]=a.useState(!1);ce(D);const y=Ae(),h=Se(),m=h?y.controller:u,{clearSelection:s,selectedOptions:d,selectOption:k}=fe(e),V=g=>{const R=ue(g,{open:!0}),T=m.active(),E=T?C(T):null;switch(R){case"First":case"Last":case"Next":case"Previous":case"PageDown":case"PageUp":case"CloseSelect":case"Select":g.preventDefault();break}switch(R){case"Next":E?m.next():m.first();break;case"Previous":E?m.prev():m.first();break;case"PageUp":case"First":m.first();break;case"PageDown":case"Last":m.last();break;case"Select":case"CloseSelect":E&&k(g,E);break}},z=N(g=>g.selectedOptions),W=N(g=>g.selectOption),P=l?{selectedOptions:z,selectOption:W,...oe}:{selectedOptions:d,selectOption:k,...oe};a.useEffect(()=>{if(!h){if(m.hideFocusVisibleAttributes(),!t)if(!r&&P.selectedOptions.length>0){const g=x(R=>R===P.selectedOptions[0]).pop();g!=null&&g.id&&m.focus(g.id)}else m.first();return()=>{m.blur()}}},[]);const L=a.useCallback(()=>{h||(m.showFocusVisibleAttributes(),c&&m.scrollActiveIntoView())},[m,h,c]),M=a.useCallback(()=>{h||m.hideFocusVisibleAttributes()},[m,h]),S={components:{root:"div"},root:ie(De("div",{ref:H(o,b,f,I),role:r?"menu":"listbox",tabIndex:0,...e}),{elementType:"div"}),standalone:!l,multiselect:r,clearSelection:s,activeDescendantController:m,onActiveDescendantChange:i,...n,...P};return S.root.onKeyDown=w(B(S.root.onKeyDown,V)),S.root.onFocus=w(B(S.root.onFocus,L)),S.root.onBlur=w(B(S.root.onBlur,M)),S},ze=(e,o)=>$(Ie,{value:o.activeDescendant,children:$(G.Provider,{value:o.listbox,children:$(e.root,{})})}),We={root:"fui-Listbox"},je=we({root:{De3pzq:"fxugw4r",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",Bf4jedk:"f3hsy1e",Bmxbyg5:"f5zp4f",Bw0xxkn:0,oeaueh:0,Bpd4iqm:0,Befb4lg:"f1iepc6i",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1t35pdg",Belr9w4:"fiut8dr"}},{d:[".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1ewtqcl{box-sizing:border-box;}",".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f3hsy1e{min-width:160px;}",".f5zp4f{overflow-y:auto;}",[".f1iepc6i{outline:1px solid var(--colorTransparentStroke);}",{p:-1}],[".f1t35pdg{padding:var(--spacingHorizontalXS);}",{p:-1}],".fiut8dr{row-gap:var(--spacingHorizontalXXS);}"]}),qe=e=>{"use no memo";const o=je();return e.root.className=Re(We.root,o.root,e.root.className),e},pe=a.forwardRef((e,o)=>{const r=He(e,o),t=Ke(r);return qe(r),Te("useListboxStyles_unstable")(r),ze(r,t)});pe.displayName="Listbox";const Ge=e=>{"use no memo";const{appearance:o="outline",disableAutoFocus:r,children:t,clearable:n=!1,editable:f=!1,inlinePopup:b=!1,mountNode:u=void 0,multiselect:l,onOpenChange:i,size:v="medium",activeDescendantController:p,freeform:C=!1,disabled:x=!1,onActiveOptionChange:I=null}=e,c=de(),{getOptionsMatchingValue:D}=c,{getOptionById:y}=c,h=a.useCallback(()=>{const O=p.active();return O?y(O):void 0},[p,y]),m=h(),s=a.useCallback(O=>{let A;if(typeof O=="function"){const j=h();A=O(j)}A?p.focus(A.id):p.blur()},[p,h]),[d,k]=a.useState(!1),[V,z]=a.useState(!1),W=a.useRef(!1),P=Be(),[L,M]=X({state:e.value,initialState:void 0}),{selectedOptions:S,selectOption:g,clearSelection:R}=fe(e),T=a.useCallback((O,A)=>{ee.unstable_batchedUpdates(()=>{M(void 0),g(O,A)})},[M,g]),E=a.useMemo(()=>{if(L!==void 0)return L;if(P&&e.defaultValue!==void 0)return e.defaultValue;const O=D(A=>S.includes(A)).map(A=>A.text);return l?f?"":O.join(", "):O[0]},[L,f,D,l,S]),[_,Y]=X({state:e.open,defaultState:e.defaultOpen,initialState:!1}),J=a.useCallback((O,A)=>{x||(i==null||i(O,{open:A}),ee.unstable_batchedUpdates(()=>{!A&&!C&&M(void 0),Y(A)}))},[i,Y,M,C,x]);a.useEffect(()=>{if(_){if(!l&&S.length>0){const O=D(A=>A===S[0]).pop();O!=null&&O.id&&p.focus(O.id)}}else p.blur()},[_,p]),a.useEffect(()=>{_&&!r&&!p.active()&&p.first()},[_,t,r,p,y]);const ve=w(O=>{const A=O.detail.previousId?c.getOptionById(O.detail.previousId):null,j=c.getOptionById(O.detail.id);I==null||I(O,{event:O,type:"change",previousOption:A,nextOption:j})});return{...c,freeform:C,disabled:x,selectOption:T,clearSelection:R,selectedOptions:S,activeOption:m,appearance:o,clearable:n,focusVisible:d,ignoreNextBlur:W,inlinePopup:b,mountNode:u,open:_,hasFocus:V,setActiveOption:s,setFocusVisible:k,setHasFocus:z,setOpen:J,setValue:M,size:v,value:E,multiselect:l,onOptionClick:w(O=>{l||J(O,!1)}),onActiveDescendantChange:ve}};function Ye(e,o,r){const{state:{multiselect:t},triggerRef:n,defaultProps:f}=r,b=Ve("fluent-listbox",Ee(e)?e.id:void 0),u=Ne(e,{renderByDefault:!0,elementType:pe,defaultProps:{id:b,multiselect:t,tabIndex:void 0,...f}}),l=Me({id:b},{supportsLabelFor:!0});u&&!u["aria-label"]&&!u["aria-labelledby"]&&l["aria-labelledby"]&&(u["aria-labelledby"]=l["aria-labelledby"]);const i=w(B(C=>{C.preventDefault()},u==null?void 0:u.onMouseDown)),v=w(B(C=>{var x;C.preventDefault(),(x=n.current)===null||x===void 0||x.focus()},u==null?void 0:u.onClick)),p=H(u==null?void 0:u.ref,o);return u&&(u.ref=p,u.onMouseDown=i,u.onClick=v),u}function Je(e,o,r){const{state:{open:t,setOpen:n,setHasFocus:f},defaultProps:b,elementType:u,activeDescendantController:l}=r,i=ie(e,{defaultProps:{type:"text","aria-expanded":t,role:"combobox",...typeof b=="object"&&b},elementType:u}),v=a.useRef(null);return i.ref=H(v,i.ref,o),i.onBlur=B(p=>{n(p,!1),f(!1)},i.onBlur),i.onFocus=B(p=>{p.target===p.currentTarget&&f(!0)},i.onFocus),i.onClick=B(p=>{n(p,!t)},i.onClick),i.onKeyDown=B($e({activeDescendantController:l,...r.state}),i.onKeyDown),i}function $e(e){const{activeDescendantController:o,getOptionById:r,setOpen:t,selectOption:n,multiselect:f,open:b}=e,u=a.useCallback(()=>{const c=o.active();return c?r(c):void 0},[o,r]),l=()=>{o.first()},i=()=>{o.last()},v=c=>{c?o.next():o.first()},p=c=>{c?o.prev():o.first()},C=()=>{for(let c=0;c<10;c++)o.prev()},x=()=>{for(let c=0;c<10;c++)o.next()},I=Fe();return w(c=>{const D=ue(c,{open:b,multiselect:f}),y=u();switch(D){case"First":case"Last":case"Next":case"Previous":case"PageDown":case"PageUp":case"Open":case"Close":case"CloseSelect":case"Select":c.preventDefault();break}switch(I(!0),D){case"First":l();break;case"Last":i();break;case"Next":v(y);break;case"Previous":p(y);break;case"PageDown":x();break;case"PageUp":C();break;case"Open":t(c,!0);break;case"Close":c.stopPropagation(),t(c,!1);break;case"CloseSelect":!f&&!(y!=null&&y.disabled)&&t(c,!1);case"Select":y&&n(c,y);break;case"Tab":!f&&y&&n(c,y);break}})}export{pe as L,Ge as a,Ye as b,Je as c,ue as g,Ue as u};
//# sourceMappingURL=useTriggerSlot-6dV4IeL8.js.map
