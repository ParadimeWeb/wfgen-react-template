import{av as se,b as w,d as a,x as be,i as ge,W as H,aw as re,ax as N,au as G,S as K,y as Q,A as j,E as Z,L as Oe,ay as xe,az as Ce,K as me,P as he,aA as ye,J as $,aa as ke,af as Ae,aB as Se,c as ie,g as De,Y as B,j as X,ad as Ie,_ as we,m as Re,e as Te,aC as Be,ai as ee,a as Ve,aD as Ee,a0 as Ne}from"./index-TdymJUst.js";function ce(e){const o=se(),r=w(e);a.useEffect(()=>{const t=o.current;if(t){const n=f=>{r(f)};return t.subscribe(n),n(t.isNavigatingWithKeyboard()),()=>{t.unsubscribe(n)}}},[o,r])}function Me(){const e=se();return a.useCallback(o=>{var r;(r=e.current)===null||r===void 0||r.setVal(o)},[e])}function Fe(e){const{matchOption:o}=e,{targetDocument:r}=be(),t=a.useRef(null),n=a.useRef(null),f=a.useCallback(l=>ge(l)&&o(l)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,[o]),b=a.useCallback(l=>{l&&r?(n.current=l,t.current=r.createTreeWalker(l,NodeFilter.SHOW_ELEMENT,f)):n.current=null},[r,f]);return{optionWalker:a.useMemo(()=>({first:()=>!t.current||!n.current?null:(t.current.currentNode=n.current,t.current.firstChild()),last:()=>!t.current||!n.current?null:(t.current.currentNode=n.current,t.current.lastChild()),next:()=>t.current?t.current.nextNode():null,prev:()=>t.current?t.current.previousNode():null,find:(l,i)=>{if(!t.current||!n.current)return null;const v=i?r==null?void 0:r.getElementById(i):null;t.current.currentNode=v??n.current;let u=t.current.currentNode;for(;u&&!l(u.id);)u=t.current.nextNode();return u},setCurrent:l=>{t.current&&(t.current.currentNode=l)}}),[r]),listboxCallbackRef:b}}const te="data-activedescendant",F="data-activedescendant-focusvisible",ne=e=>{if(!e)return;const o=ae(e.parentElement);if(!o)return;const{offsetHeight:r}=e,t=le(e,o),{scrollMarginTop:n,scrollMarginBottom:f}=Le(e),{offsetHeight:b,scrollTop:p}=o,l=t-n<p,i=t+r+f>p+b,v=2;l?o.scrollTo(0,t-n-v):i&&o.scrollTo(0,t+r+f-b+v)},ae=e=>e?e.scrollHeight>e.offsetHeight?e:ae(e.parentElement):null,le=(e,o)=>!e||e===o?0:e.contains(o)?o.offsetTop*-1:e.offsetTop+le(e.offsetParent,o),Le=e=>{var o;const r=(o=e.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!r)return{scrollMarginTop:0,scrollMarginBottom:0};const t=r.getComputedStyle(e);var n;const f=(n=U(t.scrollMarginTop))!==null&&n!==void 0?n:U(t.scrollMarginBlockStart);var b;const p=(b=U(t.scrollMarginBottom))!==null&&b!==void 0?b:U(t.scrollMarginBlockEnd);return{scrollMarginTop:f,scrollMarginBottom:p}},U=e=>e?parseInt(e,10):0,Pe=e=>new CustomEvent("activedescendantchange",{bubbles:!0,cancelable:!1,composed:!0,detail:e});function _e(e){const{imperativeRef:o,matchOption:r}=e,t=a.useRef(!1),n=a.useRef(!0),f=a.useRef(null),b=a.useRef(null),p=a.useRef(null),l=a.useRef(!0),i=a.useCallback(()=>{var s;(s=p.current)===null||s===void 0||s.removeAttribute("aria-activedescendant")},[]),v=a.useCallback(s=>{if(s&&(f.current=s),l.current&&f.current){var d;(d=p.current)===null||d===void 0||d.setAttribute("aria-activedescendant",f.current)}},[]);ce(s=>{t.current=s;const d=c();d&&(s&&n.current?d.setAttribute(F,""):d.removeAttribute(F))});const u=w(r),x=a.useRef(null),{optionWalker:y,listboxCallbackRef:I}=Fe({matchOption:u}),c=a.useCallback(()=>{var s;return(s=x.current)===null||s===void 0?void 0:s.querySelector(`#${f.current}`)},[x]),D=a.useCallback(s=>{n.current=s;const d=c();d&&(s&&t.current?d.setAttribute(F,""):d.removeAttribute(F))},[c]),m=a.useCallback(()=>{const s=c();s&&(s.removeAttribute(te),s.removeAttribute(F)),i(),b.current=f.current,f.current=null;var d;return(d=s==null?void 0:s.id)!==null&&d!==void 0?d:null},[c,i]),h=a.useCallback(s=>{if(!s)return;const d=m();ne(s),v(s.id),s.setAttribute(te,""),t.current&&n.current&&s.setAttribute(F,"");const k=Pe({id:s.id,previousId:d});s.dispatchEvent(k)},[m,v]),C=a.useMemo(()=>({first:({passive:s}={})=>{const d=y.first();return s||h(d),d==null?void 0:d.id},last:({passive:s}={})=>{const d=y.last();return s||h(d),d==null?void 0:d.id},next:({passive:s}={})=>{const d=c();if(!d)return;y.setCurrent(d);const k=y.next();return s||h(k),k==null?void 0:k.id},prev:({passive:s}={})=>{const d=c();if(!d)return;y.setCurrent(d);const k=y.prev();return s||h(k),k==null?void 0:k.id},blur:()=>{m()},active:()=>{var s;return(s=c())===null||s===void 0?void 0:s.id},focus:s=>{if(!x.current)return;const d=x.current.querySelector(`#${s}`);d&&h(d)},focusLastActive:()=>{if(!x.current||!b.current)return;const s=x.current.querySelector(`#${b.current}`);if(s)return h(s),!0},find(s,{passive:d,startFrom:k}={}){const V=y.find(s,k);return d||h(V),V==null?void 0:V.id},scrollActiveIntoView:()=>{if(!x.current)return;const s=c();s&&ne(s)},showAttributes(){l.current=!0,v()},hideAttributes(){l.current=!1,i()},showFocusVisibleAttributes(){D(!0)},hideFocusVisibleAttributes(){D(!1)}}),[y,x,v,i,h,m,c,D]);return a.useImperativeHandle(o,()=>C),{listboxRef:H(x,I),activeParentRef:p,controller:C}}function Ke(e){const o=re(G),{getOptionById:r,getOptionsMatchingValue:t,multiselect:n,registerOption:f,selectedOptions:b,selectOption:p,activeDescendantController:l}=e,i=N(c=>c.registerOption),v=N(c=>c.onOptionClick),u=N(c=>c.onActiveDescendantChange),y={activeOption:void 0,focusVisible:!1,getOptionById:r,getOptionsMatchingValue:t,multiselect:n,registerOption:o?i:f,selectedOptions:b,selectOption:p,setActiveOption:()=>{},onOptionClick:v,onActiveDescendantChange:u},I=a.useMemo(()=>({controller:l}),[l]);return{listbox:y,activeDescendant:I}}function ue(e,o={}){const{open:r=!0,multiselect:t=!1}=o,n=e.key,{altKey:f,ctrlKey:b,key:p,metaKey:l}=e;return p.length===1&&n!==K&&!f&&!b&&!l?"Type":r?n===j&&f||n===Z||!t&&n===K?"CloseSelect":t&&n===K?"Select":n===Oe?"Close":n===Q?"Next":n===j?"Previous":n===xe?"First":n===Ce?"Last":n===me?"PageUp":n===he?"PageDown":n===ye?"Tab":"None":n===Q||n===j||n===Z||n===K?"Open":"None"}const de=()=>{const e=a.useRef(new Map),o=a.useMemo(()=>({getCount:()=>e.current.size,getOptionAtIndex:()=>{},getIndexOfId:()=>-1,getOptionById:i=>e.current.get(i),getOptionsMatchingText:i=>Array.from(e.current.values()).filter(({text:v})=>i(v)),getOptionsMatchingValue:i=>{const v=[];for(const u of e.current.values())i(u.value)&&v.push(u);return v}}),[]),r=a.useCallback(t=>(e.current.set(t.id,t),()=>e.current.delete(t.id)),[]);return{...o,options:Array.from(e.current.values()),registerOption:r}},fe=e=>{const{defaultSelectedOptions:o,multiselect:r,onOptionSelect:t}=e,[n,f]=$({state:e.selectedOptions,defaultState:o,initialState:[]}),b=a.useCallback((l,i)=>{if(i.disabled)return;let v=[i.value];if(r){const u=n.findIndex(x=>x===i.value);u>-1?v=[...n.slice(0,u),...n.slice(u+1)]:v=[...n,i.value]}f(v),t==null||t(l,{optionValue:i.value,optionText:i.text,selectedOptions:v})},[t,r,n,f]);return{clearSelection:l=>{f([]),t==null||t(l,{optionValue:void 0,optionText:void 0,selectedOptions:[]})},selectOption:b,selectedOptions:n}},oe={activeOption:void 0,focusVisible:!1,setActiveOption:()=>null},Ue=(e,o)=>{"use no memo";const{multiselect:r,disableAutoFocus:t=!1}=e,n=de(),{listboxRef:f,activeParentRef:b,controller:p}=_e({matchOption:g=>g.classList.contains(ke.root)}),l=re(G),i=N(g=>g.onActiveDescendantChange),v=N(g=>g.getOptionById),u=N(g=>g.getOptionsMatchingValue),x=l?v:n.getOptionById,y=l?u:n.getOptionsMatchingValue,I=a.useMemo(()=>{let g=null;const R=T=>{const E=T;i==null||i(E)};return T=>{if(!T){g==null||g.removeEventListener("activedescendantchange",R);return}g=T,g.addEventListener("activedescendantchange",R)}},[i]),[c,D]=a.useState(!1);ce(D);const m=Ae(),h=Se(),C=h?m.controller:p,{clearSelection:s,selectedOptions:d,selectOption:k}=fe(e),V=g=>{const R=ue(g,{open:!0}),T=C.active(),E=T?x(T):null;switch(R){case"First":case"Last":case"Next":case"Previous":case"PageDown":case"PageUp":case"CloseSelect":case"Select":g.preventDefault();break}switch(R){case"Next":E?C.next():C.first();break;case"Previous":E?C.prev():C.first();break;case"PageUp":case"First":C.first();break;case"PageDown":case"Last":C.last();break;case"Select":case"CloseSelect":E&&k(g,E);break}},z=N(g=>g.selectedOptions),W=N(g=>g.selectOption),L=l?{selectedOptions:z,selectOption:W,...oe}:{selectedOptions:d,selectOption:k,...oe};a.useEffect(()=>{if(!h){if(C.hideFocusVisibleAttributes(),!t)if(!r&&L.selectedOptions.length>0){const g=y(R=>R===L.selectedOptions[0]).pop();g!=null&&g.id&&C.focus(g.id)}else C.first();return()=>{C.blur()}}},[]);const P=a.useCallback(()=>{h||(C.showFocusVisibleAttributes(),c&&C.scrollActiveIntoView())},[C,h,c]),M=a.useCallback(()=>{h||C.hideFocusVisibleAttributes()},[C,h]),S={components:{root:"div"},root:ie(De("div",{ref:H(o,b,f,I),role:r?"menu":"listbox",tabIndex:0,...e}),{elementType:"div"}),standalone:!l,multiselect:r,clearSelection:s,activeDescendantController:C,onActiveDescendantChange:i,...n,...L};return S.root.onKeyDown=w(B(S.root.onKeyDown,V)),S.root.onFocus=w(B(S.root.onFocus,P)),S.root.onBlur=w(B(S.root.onBlur,M)),S},He=(e,o)=>X(Ie,{value:o.activeDescendant,children:X(G.Provider,{value:o.listbox,children:X(e.root,{})})}),ze={root:"fui-Listbox"},We=we({root:{De3pzq:"fxugw4r",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",Bf4jedk:"f3hsy1e",Bmxbyg5:"f5zp4f",Bw0xxkn:0,oeaueh:0,Bpd4iqm:0,Befb4lg:"f1iepc6i",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1t35pdg",Belr9w4:"fiut8dr"}},{d:[".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1ewtqcl{box-sizing:border-box;}",".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f3hsy1e{min-width:160px;}",".f5zp4f{overflow-y:auto;}",[".f1iepc6i{outline:1px solid var(--colorTransparentStroke);}",{p:-1}],[".f1t35pdg{padding:var(--spacingHorizontalXS);}",{p:-1}],".fiut8dr{row-gap:var(--spacingHorizontalXXS);}"]}),qe=e=>{"use no memo";const o=We();return e.root.className=Re(ze.root,o.root,e.root.className),e},pe=a.forwardRef((e,o)=>{const r=Ue(e,o),t=Ke(r);return qe(r),Te("useListboxStyles_unstable")(r),He(r,t)});pe.displayName="Listbox";const $e=e=>{"use no memo";const{appearance:o="outline",disableAutoFocus:r,children:t,clearable:n=!1,editable:f=!1,inlinePopup:b=!1,mountNode:p=void 0,multiselect:l,onOpenChange:i,size:v="medium",activeDescendantController:u,freeform:x=!1,disabled:y=!1,onActiveOptionChange:I=null}=e,c=de(),{getOptionsMatchingValue:D}=c,{getOptionById:m}=c,h=a.useCallback(()=>{const O=u.active();return O?m(O):void 0},[u,m]),C=h(),s=a.useCallback(O=>{let A;if(typeof O=="function"){const q=h();A=O(q)}A?u.focus(A.id):u.blur()},[u,h]),[d,k]=a.useState(!1),[V,z]=a.useState(!1),W=a.useRef(!1),L=Be(),[P,M]=$({state:e.value,initialState:void 0}),{selectedOptions:S,selectOption:g,clearSelection:R}=fe(e),T=a.useCallback((O,A)=>{ee.unstable_batchedUpdates(()=>{M(void 0),g(O,A)})},[M,g]),E=a.useMemo(()=>{if(P!==void 0)return P;if(L&&e.defaultValue!==void 0)return e.defaultValue;const O=D(A=>S.includes(A)).map(A=>A.text);return l?f?"":O.join(", "):O[0]},[P,f,D,l,S]),[_,J]=$({state:e.open,defaultState:e.defaultOpen,initialState:!1}),Y=a.useCallback((O,A)=>{y||(i==null||i(O,{open:A}),ee.unstable_batchedUpdates(()=>{!A&&!x&&M(void 0),J(A)}))},[i,J,M,x,y]);a.useEffect(()=>{if(_){if(!l&&S.length>0){const O=D(A=>A===S[0]).pop();O!=null&&O.id&&u.focus(O.id)}}else u.blur()},[_,u]),a.useEffect(()=>{_&&!r&&!u.active()&&u.first()},[_,t,r,u,m]);const ve=w(O=>{const A=O.detail.previousId?c.getOptionById(O.detail.previousId):null,q=c.getOptionById(O.detail.id);I==null||I(O,{event:O,type:"change",previousOption:A,nextOption:q})});return{...c,freeform:x,disabled:y,selectOption:T,clearSelection:R,selectedOptions:S,activeOption:C,appearance:o,clearable:n,focusVisible:d,ignoreNextBlur:W,inlinePopup:b,mountNode:p,open:_,hasFocus:V,setActiveOption:s,setFocusVisible:k,setHasFocus:z,setOpen:Y,setValue:M,size:v,value:E,multiselect:l,onOptionClick:w(O=>{l||Y(O,!1)}),onActiveDescendantChange:ve}};function Ge(e,o,r){const{state:{multiselect:t},triggerRef:n,defaultProps:f}=r,b=Ve("fluent-listbox",Ee(e)?e.id:void 0),p=Ne(e,{renderByDefault:!0,elementType:pe,defaultProps:{id:b,multiselect:t,tabIndex:void 0,...f}}),l=w(B(u=>{u.preventDefault()},p==null?void 0:p.onMouseDown)),i=w(B(u=>{var x;u.preventDefault(),(x=n.current)===null||x===void 0||x.focus()},p==null?void 0:p.onClick)),v=H(p==null?void 0:p.ref,o);return p&&(p.ref=v,p.onMouseDown=l,p.onClick=i),p}function Je(e,o,r){const{state:{open:t,setOpen:n,setHasFocus:f},defaultProps:b,elementType:p,activeDescendantController:l}=r,i=ie(e,{defaultProps:{type:"text","aria-expanded":t,role:"combobox",...typeof b=="object"&&b},elementType:p}),v=a.useRef(null);return i.ref=H(v,i.ref,o),i.onBlur=B(u=>{n(u,!1),f(!1)},i.onBlur),i.onFocus=B(u=>{u.target===u.currentTarget&&f(!0)},i.onFocus),i.onClick=B(u=>{n(u,!t)},i.onClick),i.onKeyDown=B(je({activeDescendantController:l,...r.state}),i.onKeyDown),i}function je(e){const{activeDescendantController:o,getOptionById:r,setOpen:t,selectOption:n,multiselect:f,open:b}=e,p=a.useCallback(()=>{const c=o.active();return c?r(c):void 0},[o,r]),l=()=>{o.first()},i=()=>{o.last()},v=c=>{c?o.next():o.first()},u=c=>{c?o.prev():o.first()},x=()=>{for(let c=0;c<10;c++)o.prev()},y=()=>{for(let c=0;c<10;c++)o.next()},I=Me();return w(c=>{const D=ue(c,{open:b,multiselect:f}),m=p();switch(D){case"First":case"Last":case"Next":case"Previous":case"PageDown":case"PageUp":case"Open":case"Close":case"CloseSelect":case"Select":c.preventDefault();break}switch(I(!0),D){case"First":l();break;case"Last":i();break;case"Next":v(m);break;case"Previous":u(m);break;case"PageDown":y();break;case"PageUp":x();break;case"Open":t(c,!0);break;case"Close":c.stopPropagation(),t(c,!1);break;case"CloseSelect":!f&&!(m!=null&&m.disabled)&&t(c,!1);case"Select":m&&n(c,m);break;case"Tab":!f&&m&&n(c,m);break}})}export{pe as L,$e as a,Ge as b,Je as c,ue as g,_e as u};
//# sourceMappingURL=useTriggerSlot-DfFApWYc.js.map
